<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>IDHTG how to annotate plots</title>
<meta name="description" content="R notes to myself">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">


  <link href="/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="/img/favicon.png">


</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="/">R notes to myself</a></h1>
    
      <p class="sidebar-p">I am an academic @ UNSW Sydney, mother, and juggler. Learning new things and writing about it. Thoughts probably not suitable for public consumption.</p>
    
    <ul class="sidebar-menu">
      
      
        <li><a href="/about/">About</a></li>
      
        <li><a href="/post/">Blog</a></li>
      
        <li><a href="/contact/">Get in touch</a></li>
      
    </ul>
    <p class="social">
  
  
  
  <a href="https://twitter.com/JenRichmondPhD" data-animate-hover="pulse" class="external twitter">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  <a href="mailto:jrichmond@psy.unsw.edu.au" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  
  
  <a href="https://github.com/jenrichmond" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy;2018 Jenny Richmond PhD
        
        | Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="/">R notes to myself</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>IDHTG how to annotate plots</h1>
         


<p>A new post in my I Donâ€™t Have to Google (IDHTG) series. Iâ€™ve been wanting to work out how to add annotations to plots for a while and this plot from the <span class="citation">@WeAreRladies</span> account this week got me inspired!</p>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
I also looked at activity by week. You can see that there are some weeks when there was a break between curators. You can also see curators are totally different - both in terms of number of tweets and the number of retweets and replies. One curator tweeted over 200 times! ðŸ¤¯ <a href="https://t.co/F49YddjxUx">pic.twitter.com/F49YddjxUx</a>
</p>
â€” We are R-Ladies (<span class="citation">@WeAreRLadies</span>) <a href="https://twitter.com/WeAreRLadies/status/1313178171219619840?ref_src=twsrc%5Etfw">October 5, 2020</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p><br></p>
<p>Giorgia, who is curating WeAreRLadies this week, suggested checking out <a href="https://cedricscherer.netlify.app/2019/05/17/the-evolution-of-a-ggplot-ep.-1/">this blog post</a> by Cedric Scherer. It is a great illustration of how you might start with a basic box plot and turn it into something that looks REALLY fancy, step by step.</p>
<p>Lets plot some penguin data to practice.</p>
<div id="load-packages" class="section level1">
<h1>load packages</h1>
<pre class="r"><code>library(tidyverse)
library(palmerpenguins)</code></pre>
</div>
<div id="read-data" class="section level1">
<h1>read data</h1>
<pre class="r"><code>penguins &lt;- penguins</code></pre>
</div>
<div id="plot-body-mass-by-flipper-length" class="section level1">
<h1>plot body mass by flipper length</h1>
<p>Add text to a ggplot using annotate(), just define x and y coordinates and what you want the label to say.</p>
<pre class="r"><code>g_text &lt;- penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  annotate(&quot;text&quot;, x = 180, y = 6000, label = &quot;Add text here&quot;) +
  annotate(&quot;text&quot;, x = 220, y = 3000, label = &quot;More text here&quot;)
  
  
g_text</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-3-1.png" width="672" />
To add arrows, first make a tibble that has x1, x2, y1, and y2 coordinates for where you want the curved line to start and stop. On my penguin plot I want two arrows, one in the top left and another in the bottom right.</p>
<pre class="r"><code>arrows &lt;- 
  tibble(
    x1 = c(187, 212),
    x2 = c(205, 204),
    y1 = c(6000, 3000), 
    y2 = c(5500, 3500)
  )

arrows</code></pre>
<pre><code>## # A tibble: 2 x 4
##      x1    x2    y1    y2
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   187   205  6000  5500
## 2   212   204  3000  3500</code></pre>
<p>Then use geom_curve() to add arrows, adjusting and adjusting and adjusting until they fall where you want them.</p>
<pre class="r"><code>g_text +
  geom_curve(
    data = arrows, aes(x = x1, y = y1, xend = x2, yend = y2),
    arrow = arrow(length = unit(0.08, &quot;inch&quot;)), size = 0.5,
    color = &quot;gray20&quot;, curvature = -0.3)</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-5-1.png" width="672" />
We should probably make the annotations meaningful.</p>
<pre class="r"><code>penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  annotate(&quot;text&quot;, x = 180, y = 6000, label = &quot;Gentoo penguins \n are much larger&quot;) +
  annotate(&quot;text&quot;, x = 223, y = 3000, label = &quot;It is hard to differentiate \n Chinstrap and Adelie&quot;) +
  geom_curve(
    data = arrows, aes(x = x1, y = y1, xend = x2, yend = y2),
    arrow = arrow(length = unit(0.08, &quot;inch&quot;)), size = 0.5,
    color = &quot;gray20&quot;, curvature = -0.3)</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>And Miss 9 thought the colour pallete could do with some work. The Luna Lovegood palette from the <a href="https://github.com/aljrico/harrypotter">harrypotter package</a> is her favourite.</p>
<pre class="r"><code>library(harrypotter)

penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  annotate(&quot;text&quot;, x = 180, y = 6000, label = &quot;Gentoo penguins \n are much larger&quot;) +
  annotate(&quot;text&quot;, x = 223, y = 3000, label = &quot;It is hard to differentiate \n Chinstrap and Adelie&quot;) +
  geom_curve(
    data = arrows, aes(x = x1, y = y1, xend = x2, yend = y2),
    arrow = arrow(length = unit(0.08, &quot;inch&quot;)), size = 0.5,
    color = &quot;gray20&quot;, curvature = -0.3) +
  scale_colour_hp_d(option = &quot;LunaLovegood&quot;)</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-7-1.png" width="672" />
# I love twitterâ€¦ intro to ggannotate</p>
<p>One of the best things about blogging about what you learn is that you can give it away and then people let you know about new/different/easier ways to do what you just learned to do.</p>
<p>I shared this post on Twitter and within a few minutes Matt Cowgill let me know that he has been working on a package called <a href="https://github.com/MattCowgill/ggannotate">ggannotate</a> which lets you add notes and arrows to your ggplot, using a point and click interface via a Shiny app.</p>
<p>How cool is that??</p>
<p>You can install the package from github using this line of code</p>
<p><code>remotes::install_github("mattcowgill/ggannotate")</code></p>
<pre class="r"><code>library(ggannotate)</code></pre>
<p>Start with an annotation free plotâ€¦</p>
<pre class="r"><code>penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  scale_colour_hp_d(option = &quot;LunaLovegood&quot;)</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>To use ggannotate you canâ€¦</p>
<ol style="list-style-type: decimal">
<li>select the ggplot code and use the Addins pulldown to open the ggannotate tool OR</li>
<li>assign your ggplot to an object (maybe called plot) and then call ggannotate::ggannotate(plot) OR</li>
</ol>
<pre class="r"><code>plot &lt;- penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  scale_colour_hp_d(option = &quot;LunaLovegood&quot;)

ggannotate(plot)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>you can wrap your ggplot code in a ggannotate call like this</li>
</ol>
<pre class="r"><code>ggannotate(penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  scale_colour_hp_d(option = &quot;LunaLovegood&quot;))</code></pre>
<p>Each option will open a shiny app that you can use to point and click where you want your annotations/curves and then copy the code back into your markdown. The downside is that at this stage you need to add each annotation and curve separately and the code that the tool generates is longer than if you had done it manually. But you donâ€™t have to write it so I guess that doesnâ€™t matter!</p>
<p>Matt said that adding multiple annotations in single call is in the works, so watch this space.</p>
<pre class="r"><code>penguins %&gt;%
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, colour = species)) +
  geom_point() +
  scale_colour_hp_d(option = &quot;LunaLovegood&quot;) +
  geom_text(data = data.frame(x = 188.437797399636, y = 5990.9008070379, label = &quot;Gentoo penguins are much larger&quot;),
mapping = aes(x = x, y = y, label = label),
size = 3.86605783866058, alpha = 1, inherit.aes = FALSE) +
  geom_text(data = data.frame(x = 219.749643585604, y = 3366.61344597189, label = &quot;It is hard to differentiate \n Chinstrap and Gentoo&quot;),
mapping = aes(x = x, y = y, label = label),
size = 3.86605783866058, alpha = 1, inherit.aes = FALSE) +
  geom_curve(data = data.frame(x = 199.308325132123, y = 6014.12458899424, xend = 208.642800032846, yend = 5781.88676943088),
mapping = aes(x = x, y = y, xend = xend, yend = yend),
curvature = -0.515, arrow = arrow(30L, unit(0.1, &quot;inches&quot;),
&quot;last&quot;, &quot;closed&quot;),
alpha = 1, inherit.aes = FALSE) +
  geom_curve(data = data.frame(x = 211.833063606511, y = 3320.16588205921, xend = 203.443851986874, yend = 3680.13450238243),
mapping = aes(x = x, y = y, xend = xend, yend = yend),
curvature = -0.59, arrow = arrow(30L, unit(0.1, &quot;inches&quot;),
&quot;last&quot;, &quot;closed&quot;),
alpha = 1, inherit.aes = FALSE)</code></pre>
<p><img src="/post/2020-10-14-idhtg-how-to-annotate-plots_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.cookie.js"> </script>
<script src="/js/ekko-lightbox.js"></script>
<script src="/js/jquery.scrollTo.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/front.js"></script>

</body>
</html>
